


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torchvision.transforms.v2._geometry &mdash; Torchvision main documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/custom_torchvision.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T8XT4PS');</script>
    <!-- End Google Tag Manager -->
  

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Edge
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/edge">
                  <span class="dropdown-title">About PyTorch Edge</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/executorch">
                  <span class="dropdown-title">ExecuTorch</span>
                </a>
              </div>
            </div>  
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active docs-active">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
                  <span class="dropdown-title">torchaudio</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
                  <span class="dropdown-title">torchtext</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/vision/stable/index.html">
                  <span class="dropdown-title">torchvision</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/torcharrow">
                  <span class="dropdown-title">torcharrow</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/data">
                  <span class="dropdown-title">TorchData</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/torchrec">
                  <span class="dropdown-title">TorchRec</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
                  <span class="dropdown-title">TorchServe</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/torchx/">
                  <span class="dropdown-title">TorchX</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
                  <span class="dropdown-title">PyTorch on XLA Devices</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class="dropdown-title">About</span>
                  <p>Learn about PyTorchâ€™s features and capabilities</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/foundation">
                  <span class="dropdown-title">PyTorch Foundation</span>
                  <p>Learn about the PyTorch foundation</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class="dropdown-title">Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/community-stories">
                  <span class="dropdown-title">Community Stories</span>
                  <p>Learn how our community solves real, everyday machine learning problems with PyTorch.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class="dropdown-title">Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/events">
                  <span class="dropdown-title">Events</span>
                  <p>Find events, webinars, and podcasts</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/hub">
                  <span class="dropdown-title">Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            
    <div class="version">
      <a href='https://pytorch.org/vision/versions.html'>main (0.18.0a0+5ab80c9) &#x25BC</a>
    </div>
    


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          </div>

          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../transforms.html">Transforming and augmenting images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tv_tensors.html">TVTensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models.html">Models and pre-trained weights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ops.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io.html">Decoding / Encoding images and videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../feature_extraction.html">Feature extraction for model inspection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples and training references</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../auto_examples/index.html">Examples and tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../training_references.html">Training references</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PyTorch Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/docs">PyTorch</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/audio">torchaudio</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/text">torchtext</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/vision">torchvision</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/elastic/">TorchElastic</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/serve">TorchServe</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pytorch.org/xla/">PyTorch on XLA Devices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../../index.html">Module code</a> &gt;</li>
        
          <li><a href="../../../torchvision.html">torchvision</a> &gt;</li>
        
      <li>torchvision.transforms.v2._geometry</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          <!-- Google Tag Manager (noscript) -->
          <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8XT4PS"
          height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
          <!-- End Google Tag Manager (noscript) -->
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>Source code for torchvision.transforms.v2._geometry</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">PIL.Image</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span> <span class="k">as</span> <span class="n">_transforms</span><span class="p">,</span> <span class="n">tv_tensors</span>
<span class="kn">from</span> <span class="nn">torchvision.ops.boxes</span> <span class="kn">import</span> <span class="n">box_iou</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms.functional</span> <span class="kn">import</span> <span class="n">_get_perspective_coeffs</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms.v2</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span><span class="p">,</span> <span class="n">InterpolationMode</span><span class="p">,</span> <span class="n">Transform</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms.v2.functional._utils</span> <span class="kn">import</span> <span class="n">_FillType</span>

<span class="kn">from</span> <span class="nn">._transform</span> <span class="kn">import</span> <span class="n">_RandomApplyTransform</span>
<span class="kn">from</span> <span class="nn">._utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_check_padding_arg</span><span class="p">,</span>
    <span class="n">_check_padding_mode_arg</span><span class="p">,</span>
    <span class="n">_check_sequence_input</span><span class="p">,</span>
    <span class="n">_get_fill</span><span class="p">,</span>
    <span class="n">_setup_angle</span><span class="p">,</span>
    <span class="n">_setup_fill_arg</span><span class="p">,</span>
    <span class="n">_setup_number_or_seq</span><span class="p">,</span>
    <span class="n">_setup_size</span><span class="p">,</span>
    <span class="n">get_bounding_boxes</span><span class="p">,</span>
    <span class="n">has_all</span><span class="p">,</span>
    <span class="n">has_any</span><span class="p">,</span>
    <span class="n">is_pure_tensor</span><span class="p">,</span>
    <span class="n">query_size</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="RandomHorizontalFlip"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomHorizontalFlip.html#torchvision.transforms.v2.RandomHorizontalFlip">[docs]</a><span class="k">class</span> <span class="nc">RandomHorizontalFlip</span><span class="p">(</span><span class="n">_RandomApplyTransform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Horizontally flip the input with a given probability.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        p (float, optional): probability of the input being flipped. Default value is 0.5</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">horizontal_flip</span><span class="p">,</span> <span class="n">inpt</span><span class="p">)</span></div>


<div class="viewcode-block" id="RandomVerticalFlip"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomVerticalFlip.html#torchvision.transforms.v2.RandomVerticalFlip">[docs]</a><span class="k">class</span> <span class="nc">RandomVerticalFlip</span><span class="p">(</span><span class="n">_RandomApplyTransform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vertically flip the input with a given probability.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        p (float, optional): probability of the input being flipped. Default value is 0.5</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">RandomVerticalFlip</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">vertical_flip</span><span class="p">,</span> <span class="n">inpt</span><span class="p">)</span></div>


<div class="viewcode-block" id="Resize"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.Resize.html#torchvision.transforms.v2.Resize">[docs]</a><span class="k">class</span> <span class="nc">Resize</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resize the input to the given size.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (sequence or int): Desired output size. If size is a sequence like</span>
<span class="sd">            (h, w), output size will be matched to this. If size is an int,</span>
<span class="sd">            smaller edge of the image will be matched to this number.</span>
<span class="sd">            i.e, if height &gt; width, then image will be rescaled to</span>
<span class="sd">            (size * height / width, size).</span>

<span class="sd">            .. note::</span>
<span class="sd">                In torchscript mode size as single int is not supported, use a sequence of length 1: ``[size, ]``.</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.BILINEAR``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.NEAREST_EXACT``,</span>
<span class="sd">            ``InterpolationMode.BILINEAR`` and ``InterpolationMode.BICUBIC`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        max_size (int, optional): The maximum allowed for the longer edge of</span>
<span class="sd">            the resized image. If the longer edge of the image is greater</span>
<span class="sd">            than ``max_size`` after being resized according to ``size``,</span>
<span class="sd">            ``size`` will be overruled so that the longer edge is equal to</span>
<span class="sd">            ``max_size``.</span>
<span class="sd">            As a result, the smaller edge may be shorter than ``size``. This</span>
<span class="sd">            is only supported if ``size`` is an int (or a sequence of length</span>
<span class="sd">            1 in torchscript mode).</span>
<span class="sd">        antialias (bool, optional): Whether to apply antialiasing.</span>
<span class="sd">            It only affects **tensors** with bilinear or bicubic modes and it is</span>
<span class="sd">            ignored otherwise: on PIL images, antialiasing is always applied on</span>
<span class="sd">            bilinear or bicubic modes; on other modes (for PIL images and</span>
<span class="sd">            tensors), antialiasing makes no sense and this parameter is ignored.</span>
<span class="sd">            Possible values are:</span>

<span class="sd">            - ``True`` (default): will apply antialiasing for bilinear or bicubic modes.</span>
<span class="sd">              Other mode aren&#39;t affected. This is probably what you want to use.</span>
<span class="sd">            - ``False``: will not apply antialiasing for tensors on any mode. PIL</span>
<span class="sd">              images are still antialiased on bilinear or bicubic modes, because</span>
<span class="sd">              PIL doesn&#39;t support no antialias.</span>
<span class="sd">            - ``None``: equivalent to ``False`` for tensors and ``True`` for</span>
<span class="sd">              PIL images. This value exists for legacy reasons and you probably</span>
<span class="sd">              don&#39;t want to use it unless you really know what you are doing.</span>

<span class="sd">            The default value changed from ``None`` to ``True`` in</span>
<span class="sd">            v0.17, for the PIL and Tensor backends to be consistent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">Resize</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
        <span class="n">max_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">antialias</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="n">size</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;size can either be an integer or a sequence of one or two integers, but got </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> instead.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">=</span> <span class="n">max_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antialias</span> <span class="o">=</span> <span class="n">antialias</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">resize</span><span class="p">,</span>
            <span class="n">inpt</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span>
            <span class="n">max_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">,</span>
            <span class="n">antialias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">antialias</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="CenterCrop"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.CenterCrop.html#torchvision.transforms.v2.CenterCrop">[docs]</a><span class="k">class</span> <span class="nc">CenterCrop</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Crop the input at the center.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    If image size is smaller than output size along any edge, image is padded with 0 and then center cropped.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (sequence or int): Desired output size of the crop. If size is an</span>
<span class="sd">            int instead of sequence like (h, w), a square crop (size, size) is</span>
<span class="sd">            made. If provided a sequence of length 1, it will be interpreted as (size[0], size[0]).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">CenterCrop</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">_setup_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;Please provide only two dimensions (h, w) for size.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">center_crop</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></div>


<div class="viewcode-block" id="RandomResizedCrop"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomResizedCrop.html#torchvision.transforms.v2.RandomResizedCrop">[docs]</a><span class="k">class</span> <span class="nc">RandomResizedCrop</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Crop a random portion of the input and resize it to a given size.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    A crop of the original input is made: the crop has a random area (H * W)</span>
<span class="sd">    and a random aspect ratio. This crop is finally resized to the given</span>
<span class="sd">    size. This is popularly used to train the Inception networks.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int or sequence): expected output size of the crop, for each edge. If size is an</span>
<span class="sd">            int instead of sequence like (h, w), a square output size ``(size, size)`` is</span>
<span class="sd">            made. If provided a sequence of length 1, it will be interpreted as (size[0], size[0]).</span>

<span class="sd">            .. note::</span>
<span class="sd">                In torchscript mode size as single int is not supported, use a sequence of length 1: ``[size, ]``.</span>
<span class="sd">        scale (tuple of float, optional): Specifies the lower and upper bounds for the random area of the crop,</span>
<span class="sd">            before resizing. The scale is defined with respect to the area of the original image.</span>
<span class="sd">        ratio (tuple of float, optional): lower and upper bounds for the random aspect ratio of the crop, before</span>
<span class="sd">            resizing.</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.BILINEAR``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.NEAREST_EXACT``,</span>
<span class="sd">            ``InterpolationMode.BILINEAR`` and ``InterpolationMode.BICUBIC`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        antialias (bool, optional): Whether to apply antialiasing.</span>
<span class="sd">            It only affects **tensors** with bilinear or bicubic modes and it is</span>
<span class="sd">            ignored otherwise: on PIL images, antialiasing is always applied on</span>
<span class="sd">            bilinear or bicubic modes; on other modes (for PIL images and</span>
<span class="sd">            tensors), antialiasing makes no sense and this parameter is ignored.</span>
<span class="sd">            Possible values are:</span>

<span class="sd">            - ``True`` (default): will apply antialiasing for bilinear or bicubic modes.</span>
<span class="sd">              Other mode aren&#39;t affected. This is probably what you want to use.</span>
<span class="sd">            - ``False``: will not apply antialiasing for tensors on any mode. PIL</span>
<span class="sd">              images are still antialiased on bilinear or bicubic modes, because</span>
<span class="sd">              PIL doesn&#39;t support no antialias.</span>
<span class="sd">            - ``None``: equivalent to ``False`` for tensors and ``True`` for</span>
<span class="sd">              PIL images. This value exists for legacy reasons and you probably</span>
<span class="sd">              don&#39;t want to use it unless you really know what you are doing.</span>

<span class="sd">            The default value changed from ``None`` to ``True`` in</span>
<span class="sd">            v0.17, for the PIL and Tensor backends to be consistent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">RandomResizedCrop</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">scale</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="n">ratio</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">),</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
        <span class="n">antialias</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">_setup_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;Please provide only two dimensions (h, w) for size.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Scale should be a sequence&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Ratio should be a sequence&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ratio</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ratio</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Scale and ratio should be of kind (min, max)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span> <span class="o">=</span> <span class="n">ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antialias</span> <span class="o">=</span> <span class="n">antialias</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log_ratio</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>
        <span class="n">area</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="n">width</span>

        <span class="n">log_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_ratio</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">target_area</span> <span class="o">=</span> <span class="n">area</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
            <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span>
                    <span class="n">log_ratio</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># type: ignore[arg-type]</span>
                    <span class="n">log_ratio</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># type: ignore[arg-type]</span>
                <span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

            <span class="n">w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">target_area</span> <span class="o">*</span> <span class="n">aspect_ratio</span><span class="p">)))</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">target_area</span> <span class="o">/</span> <span class="n">aspect_ratio</span><span class="p">)))</span>

            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">w</span> <span class="o">&lt;=</span> <span class="n">width</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">h</span> <span class="o">&lt;=</span> <span class="n">height</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="n">h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Fallback to central crop</span>
            <span class="n">in_ratio</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">in_ratio</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">):</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">width</span>
                <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">)))</span>
            <span class="k">elif</span> <span class="n">in_ratio</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">):</span>
                <span class="n">h</span> <span class="o">=</span> <span class="n">height</span>
                <span class="n">w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># whole image</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">width</span>
                <span class="n">h</span> <span class="o">=</span> <span class="n">height</span>
            <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">resized_crop</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">antialias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">antialias</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="FiveCrop"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.FiveCrop.html#torchvision.transforms.v2.FiveCrop">[docs]</a><span class="k">class</span> <span class="nc">FiveCrop</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Crop the image or video into four corners and the central crop.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a :class:`~torchvision.tv_tensors.Image` or a</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video` it can have arbitrary number of leading batch dimensions.</span>
<span class="sd">    For example, the image can have ``[..., C, H, W]`` shape.</span>

<span class="sd">    .. Note::</span>
<span class="sd">         This transform returns a tuple of images and there may be a mismatch in the number of</span>
<span class="sd">         inputs and targets your Dataset returns. See below for an example of how to deal with</span>
<span class="sd">         this.</span>

<span class="sd">    Args:</span>
<span class="sd">         size (sequence or int): Desired output size of the crop. If size is an ``int``</span>
<span class="sd">            instead of sequence like (h, w), a square crop of size (size, size) is made.</span>
<span class="sd">            If provided a sequence of length 1, it will be interpreted as (size[0], size[0]).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; class BatchMultiCrop(transforms.Transform):</span>
<span class="sd">        ...     def forward(self, sample: Tuple[Tuple[Union[tv_tensors.Image, tv_tensors.Video], ...], int]):</span>
<span class="sd">        ...         images_or_videos, labels = sample</span>
<span class="sd">        ...         batch_size = len(images_or_videos)</span>
<span class="sd">        ...         image_or_video = images_or_videos[0]</span>
<span class="sd">        ...         images_or_videos = tv_tensors.wrap(torch.stack(images_or_videos), like=image_or_video)</span>
<span class="sd">        ...         labels = torch.full((batch_size,), label, device=images_or_videos.device)</span>
<span class="sd">        ...         return images_or_videos, labels</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; image = tv_tensors.Image(torch.rand(3, 256, 256))</span>
<span class="sd">        &gt;&gt;&gt; label = 3</span>
<span class="sd">        &gt;&gt;&gt; transform = transforms.Compose([transforms.FiveCrop(224), BatchMultiCrop()])</span>
<span class="sd">        &gt;&gt;&gt; images, labels = transform(image, label)</span>
<span class="sd">        &gt;&gt;&gt; images.shape</span>
<span class="sd">        torch.Size([5, 3, 224, 224])</span>
<span class="sd">        &gt;&gt;&gt; labels</span>
<span class="sd">        tensor([3, 3, 3, 3, 3])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">FiveCrop</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">_setup_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;Please provide only two dimensions (h, w) for size.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_call_kernel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">functional</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inpt</span><span class="p">,</span> <span class="p">(</span><span class="n">tv_tensors</span><span class="o">.</span><span class="n">BoundingBoxes</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">Mask</span><span class="p">)):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">() is currently passing through inputs of type &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;tv_tensors.</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">. This will likely change in the future.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">functional</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">five_crop</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">has_any</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">BoundingBoxes</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">Mask</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BoundingBoxes&#39;es and Mask&#39;s are not supported by </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">()&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TenCrop"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.TenCrop.html#torchvision.transforms.v2.TenCrop">[docs]</a><span class="k">class</span> <span class="nc">TenCrop</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Crop the image or video into four corners and the central crop plus the flipped version of</span>
<span class="sd">    these (horizontal flipping is used by default).</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a :class:`~torchvision.tv_tensors.Image` or a</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video` it can have arbitrary number of leading batch dimensions.</span>
<span class="sd">    For example, the image can have ``[..., C, H, W]`` shape.</span>

<span class="sd">    See :class:`~torchvision.transforms.v2.FiveCrop` for an example.</span>

<span class="sd">    .. Note::</span>
<span class="sd">         This transform returns a tuple of images and there may be a mismatch in the number of</span>
<span class="sd">         inputs and targets your Dataset returns. See below for an example of how to deal with</span>
<span class="sd">         this.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (sequence or int): Desired output size of the crop. If size is an</span>
<span class="sd">            int instead of sequence like (h, w), a square crop (size, size) is</span>
<span class="sd">            made. If provided a sequence of length 1, it will be interpreted as (size[0], size[0]).</span>
<span class="sd">        vertical_flip (bool, optional): Use vertical flipping instead of horizontal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">TenCrop</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="n">vertical_flip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">_setup_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;Please provide only two dimensions (h, w) for size.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertical_flip</span> <span class="o">=</span> <span class="n">vertical_flip</span>

    <span class="k">def</span> <span class="nf">_call_kernel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">functional</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inpt</span><span class="p">,</span> <span class="p">(</span><span class="n">tv_tensors</span><span class="o">.</span><span class="n">BoundingBoxes</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">Mask</span><span class="p">)):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">() is currently passing through inputs of type &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;tv_tensors.</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">. This will likely change in the future.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">functional</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">has_any</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">BoundingBoxes</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">Mask</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BoundingBoxes&#39;es and Mask&#39;s are not supported by </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">()&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ten_crop</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">vertical_flip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vertical_flip</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pad"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.Pad.html#torchvision.transforms.v2.Pad">[docs]</a><span class="k">class</span> <span class="nc">Pad</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pad the input on all sides with the given &quot;pad&quot; value.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        padding (int or sequence): Padding on each border. If a single int is provided this</span>
<span class="sd">            is used to pad all borders. If sequence of length 2 is provided this is the padding</span>
<span class="sd">            on left/right and top/bottom respectively. If a sequence of length 4 is provided</span>
<span class="sd">            this is the padding for the left, top, right and bottom borders respectively.</span>

<span class="sd">            .. note::</span>
<span class="sd">                In torchscript mode padding as single int is not supported, use a sequence of</span>
<span class="sd">                length 1: ``[padding, ]``.</span>
<span class="sd">        fill (number or tuple or dict, optional): Pixel fill value used when the  ``padding_mode`` is constant.</span>
<span class="sd">            Default is 0. If a tuple of length 3, it is used to fill R, G, B channels respectively.</span>
<span class="sd">            Fill value can be also a dictionary mapping data type to the fill value, e.g.</span>
<span class="sd">            ``fill={tv_tensors.Image: 127, tv_tensors.Mask: 0}`` where ``Image`` will be filled with 127 and</span>
<span class="sd">            ``Mask`` will be filled with 0.</span>
<span class="sd">        padding_mode (str, optional): Type of padding. Should be: constant, edge, reflect or symmetric.</span>
<span class="sd">            Default is &quot;constant&quot;.</span>

<span class="sd">            - constant: pads with a constant value, this value is specified with fill</span>

<span class="sd">            - edge: pads with the last value at the edge of the image.</span>

<span class="sd">            - reflect: pads with reflection of image without repeating the last value on the edge.</span>
<span class="sd">              For example, padding [1, 2, 3, 4] with 2 elements on both sides in reflect mode</span>
<span class="sd">              will result in [3, 2, 1, 2, 3, 4, 3, 2]</span>

<span class="sd">            - symmetric: pads with reflection of image repeating the last value on the edge.</span>
<span class="sd">              For example, padding [1, 2, 3, 4] with 2 elements on both sides in symmetric mode</span>
<span class="sd">              will result in [2, 1, 1, 2, 3, 4, 4, 3]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">Pad</span>

    <span class="k">def</span> <span class="nf">_extract_params_for_v1_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_extract_params_for_v1_transform</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">() can only be scripted for a scalar `fill`, but got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">padding</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_FillType</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_FillType</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">padding_mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span> <span class="s2">&quot;reflect&quot;</span><span class="p">,</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="n">_check_padding_arg</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="n">_check_padding_mode_arg</span><span class="p">(</span><span class="n">padding_mode</span><span class="p">)</span>

        <span class="c1"># This cast does Sequence[int] -&gt; List[int] and is required to make mypy happy</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">padding</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">_setup_fill_arg</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding_mode</span> <span class="o">=</span> <span class="n">padding_mode</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">_get_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding_mode</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span></div>


<div class="viewcode-block" id="RandomZoomOut"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomZoomOut.html#torchvision.transforms.v2.RandomZoomOut">[docs]</a><span class="k">class</span> <span class="nc">RandomZoomOut</span><span class="p">(</span><span class="n">_RandomApplyTransform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; &quot;Zoom out&quot; transformation from</span>
<span class="sd">    `&quot;SSD: Single Shot MultiBox Detector&quot; &lt;https://arxiv.org/abs/1512.02325&gt;`_.</span>

<span class="sd">    This transformation randomly pads images, videos, bounding boxes and masks creating a zoom out effect.</span>
<span class="sd">    Output spatial size is randomly sampled from original size up to a maximum size configured</span>
<span class="sd">    with ``side_range`` parameter:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        r = uniform_sample(side_range[0], side_range[1])</span>
<span class="sd">        output_width = input_width * r</span>
<span class="sd">        output_height = input_height * r</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        fill (number or tuple or dict, optional): Pixel fill value used when the  ``padding_mode`` is constant.</span>
<span class="sd">            Default is 0. If a tuple of length 3, it is used to fill R, G, B channels respectively.</span>
<span class="sd">            Fill value can be also a dictionary mapping data type to the fill value, e.g.</span>
<span class="sd">            ``fill={tv_tensors.Image: 127, tv_tensors.Mask: 0}`` where ``Image`` will be filled with 127 and</span>
<span class="sd">            ``Mask`` will be filled with 0.</span>
<span class="sd">        side_range (sequence of floats, optional): tuple of two floats defines minimum and maximum factors to</span>
<span class="sd">            scale the input size.</span>
<span class="sd">        p (float, optional): probability that the zoom operation will be performed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_FillType</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_FillType</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">side_range</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">_setup_fill_arg</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>

        <span class="n">_check_sequence_input</span><span class="p">(</span><span class="n">side_range</span><span class="p">,</span> <span class="s2">&quot;side_range&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">side_range</span> <span class="o">=</span> <span class="n">side_range</span>
        <span class="k">if</span> <span class="n">side_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">side_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">side_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid side range provided </span><span class="si">{</span><span class="n">side_range</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">orig_h</span><span class="p">,</span> <span class="n">orig_w</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">side_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">side_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">side_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">canvas_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_w</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">canvas_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_h</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">canvas_width</span> <span class="o">-</span> <span class="n">orig_w</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">top</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">canvas_height</span> <span class="o">-</span> <span class="n">orig_h</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">canvas_width</span> <span class="o">-</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">orig_w</span><span class="p">)</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="n">canvas_height</span> <span class="o">-</span> <span class="p">(</span><span class="n">top</span> <span class="o">+</span> <span class="n">orig_h</span><span class="p">)</span>
        <span class="n">padding</span> <span class="o">=</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">_get_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span></div>


<div class="viewcode-block" id="RandomRotation"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomRotation.html#torchvision.transforms.v2.RandomRotation">[docs]</a><span class="k">class</span> <span class="nc">RandomRotation</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate the input by angle.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        degrees (sequence or number): Range of degrees to select from.</span>
<span class="sd">            If degrees is a number instead of sequence like (min, max), the range of degrees</span>
<span class="sd">            will be (-degrees, +degrees).</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.NEAREST``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.BILINEAR`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        expand (bool, optional): Optional expansion flag.</span>
<span class="sd">            If true, expands the output to make it large enough to hold the entire rotated image.</span>
<span class="sd">            If false or omitted, make the output image the same size as the input image.</span>
<span class="sd">            Note that the expand flag assumes rotation around the center (see note below) and no translation.</span>
<span class="sd">        center (sequence, optional): Optional center of rotation, (x, y). Origin is the upper left corner.</span>
<span class="sd">            Default is the center of the image.</span>

<span class="sd">            .. note::</span>

<span class="sd">                In theory, setting ``center`` has no effect if ``expand=True``, since the image center will become the</span>
<span class="sd">                center of rotation. In practice however, due to numerical precision, this can lead to off-by-one</span>
<span class="sd">                differences of the resulting image size compared to using the image center in the first place. Thus, when</span>
<span class="sd">                setting ``expand=True``, it&#39;s best to leave ``center=None`` (default).</span>
<span class="sd">        fill (number or tuple or dict, optional): Pixel fill value used when the  ``padding_mode`` is constant.</span>
<span class="sd">            Default is 0. If a tuple of length 3, it is used to fill R, G, B channels respectively.</span>
<span class="sd">            Fill value can be also a dictionary mapping data type to the fill value, e.g.</span>
<span class="sd">            ``fill={tv_tensors.Image: 127, tv_tensors.Mask: 0}`` where ``Image`` will be filled with 127 and</span>
<span class="sd">            ``Mask`` will be filled with 0.</span>

<span class="sd">    .. _filters: https://pillow.readthedocs.io/en/latest/handbook/concepts.html#filters</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">RandomRotation</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">degrees</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">],</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">NEAREST</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">center</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_FillType</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_FillType</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span> <span class="o">=</span> <span class="n">_setup_angle</span><span class="p">(</span><span class="n">degrees</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;degrees&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expand</span> <span class="o">=</span> <span class="n">expand</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">_setup_fill_arg</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">center</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_check_sequence_input</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">degrees</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">_get_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span>
            <span class="n">inpt</span><span class="p">,</span>
            <span class="o">**</span><span class="n">params</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span>
            <span class="n">expand</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="RandomAffine"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomAffine.html#torchvision.transforms.v2.RandomAffine">[docs]</a><span class="k">class</span> <span class="nc">RandomAffine</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Random affine transformation the input keeping center invariant.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        degrees (sequence or number): Range of degrees to select from.</span>
<span class="sd">            If degrees is a number instead of sequence like (min, max), the range of degrees</span>
<span class="sd">            will be (-degrees, +degrees). Set to 0 to deactivate rotations.</span>
<span class="sd">        translate (tuple, optional): tuple of maximum absolute fraction for horizontal</span>
<span class="sd">            and vertical translations. For example translate=(a, b), then horizontal shift</span>
<span class="sd">            is randomly sampled in the range -img_width * a &lt; dx &lt; img_width * a and vertical shift is</span>
<span class="sd">            randomly sampled in the range -img_height * b &lt; dy &lt; img_height * b. Will not translate by default.</span>
<span class="sd">        scale (tuple, optional): scaling factor interval, e.g (a, b), then scale is</span>
<span class="sd">            randomly sampled from the range a &lt;= scale &lt;= b. Will keep original scale by default.</span>
<span class="sd">        shear (sequence or number, optional): Range of degrees to select from.</span>
<span class="sd">            If shear is a number, a shear parallel to the x-axis in the range (-shear, +shear)</span>
<span class="sd">            will be applied. Else if shear is a sequence of 2 values a shear parallel to the x-axis in the</span>
<span class="sd">            range (shear[0], shear[1]) will be applied. Else if shear is a sequence of 4 values,</span>
<span class="sd">            an x-axis shear in (shear[0], shear[1]) and y-axis shear in (shear[2], shear[3]) will be applied.</span>
<span class="sd">            Will not apply shear by default.</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.NEAREST``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.BILINEAR`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        fill (number or tuple or dict, optional): Pixel fill value used when the  ``padding_mode`` is constant.</span>
<span class="sd">            Default is 0. If a tuple of length 3, it is used to fill R, G, B channels respectively.</span>
<span class="sd">            Fill value can be also a dictionary mapping data type to the fill value, e.g.</span>
<span class="sd">            ``fill={tv_tensors.Image: 127, tv_tensors.Mask: 0}`` where ``Image`` will be filled with 127 and</span>
<span class="sd">            ``Mask`` will be filled with 0.</span>
<span class="sd">        center (sequence, optional): Optional center of rotation, (x, y). Origin is the upper left corner.</span>
<span class="sd">            Default is the center of the image.</span>

<span class="sd">    .. _filters: https://pillow.readthedocs.io/en/latest/handbook/concepts.html#filters</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">RandomAffine</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">degrees</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">],</span>
        <span class="n">translate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shear</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">NEAREST</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_FillType</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_FillType</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">center</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span> <span class="o">=</span> <span class="n">_setup_angle</span><span class="p">(</span><span class="n">degrees</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;degrees&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
        <span class="k">if</span> <span class="n">translate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_check_sequence_input</span><span class="p">(</span><span class="n">translate</span><span class="p">,</span> <span class="s2">&quot;translate&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">translate</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;translation values should be between 0 and 1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translate</span> <span class="o">=</span> <span class="n">translate</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_check_sequence_input</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scale</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;scale values should be positive&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

        <span class="k">if</span> <span class="n">shear</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">=</span> <span class="n">_setup_angle</span><span class="p">(</span><span class="n">shear</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;shear&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">_setup_fill_arg</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">center</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_check_sequence_input</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">req_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>

        <span class="n">angle</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">degrees</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_dx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
            <span class="n">max_dy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>
            <span class="n">tx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="o">-</span><span class="n">max_dx</span><span class="p">,</span> <span class="n">max_dx</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
            <span class="n">ty</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="o">-</span><span class="n">max_dy</span><span class="p">,</span> <span class="n">max_dy</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
            <span class="n">translate</span> <span class="o">=</span> <span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">translate</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="n">shear_x</span> <span class="o">=</span> <span class="n">shear_y</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">shear_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">shear_y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

        <span class="n">shear</span> <span class="o">=</span> <span class="p">(</span><span class="n">shear_x</span><span class="p">,</span> <span class="n">shear_y</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="n">shear</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">_get_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">affine</span><span class="p">,</span>
            <span class="n">inpt</span><span class="p">,</span>
            <span class="o">**</span><span class="n">params</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="RandomCrop"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomCrop.html#torchvision.transforms.v2.RandomCrop">[docs]</a><span class="k">class</span> <span class="nc">RandomCrop</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Crop the input at a random location.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (sequence or int): Desired output size of the crop. If size is an</span>
<span class="sd">            int instead of sequence like (h, w), a square crop (size, size) is</span>
<span class="sd">            made. If provided a sequence of length 1, it will be interpreted as (size[0], size[0]).</span>
<span class="sd">        padding (int or sequence, optional): Optional padding on each border</span>
<span class="sd">            of the image. Default is None. If a single int is provided this</span>
<span class="sd">            is used to pad all borders. If sequence of length 2 is provided this is the padding</span>
<span class="sd">            on left/right and top/bottom respectively. If a sequence of length 4 is provided</span>
<span class="sd">            this is the padding for the left, top, right and bottom borders respectively.</span>

<span class="sd">            .. note::</span>
<span class="sd">                In torchscript mode padding as single int is not supported, use a sequence of</span>
<span class="sd">                length 1: ``[padding, ]``.</span>
<span class="sd">        pad_if_needed (boolean, optional): It will pad the image if smaller than the</span>
<span class="sd">            desired size to avoid raising an exception. Since cropping is done</span>
<span class="sd">            after padding, the padding seems to be done at a random offset.</span>
<span class="sd">        fill (number or tuple or dict, optional): Pixel fill value used when the  ``padding_mode`` is constant.</span>
<span class="sd">            Default is 0. If a tuple of length 3, it is used to fill R, G, B channels respectively.</span>
<span class="sd">            Fill value can be also a dictionary mapping data type to the fill value, e.g.</span>
<span class="sd">            ``fill={tv_tensors.Image: 127, tv_tensors.Mask: 0}`` where ``Image`` will be filled with 127 and</span>
<span class="sd">            ``Mask`` will be filled with 0.</span>
<span class="sd">        padding_mode (str, optional): Type of padding. Should be: constant, edge, reflect or symmetric.</span>
<span class="sd">            Default is constant.</span>

<span class="sd">            - constant: pads with a constant value, this value is specified with fill</span>

<span class="sd">            - edge: pads with the last value at the edge of the image.</span>

<span class="sd">            - reflect: pads with reflection of image without repeating the last value on the edge.</span>
<span class="sd">              For example, padding [1, 2, 3, 4] with 2 elements on both sides in reflect mode</span>
<span class="sd">              will result in [3, 2, 1, 2, 3, 4, 3, 2]</span>

<span class="sd">            - symmetric: pads with reflection of image repeating the last value on the edge.</span>
<span class="sd">              For example, padding [1, 2, 3, 4] with 2 elements on both sides in symmetric mode</span>
<span class="sd">              will result in [2, 1, 1, 2, 3, 4, 4, 3]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">RandomCrop</span>

    <span class="k">def</span> <span class="nf">_extract_params_for_v1_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_extract_params_for_v1_transform</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">() can only be scripted for a scalar `fill`, but got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="n">padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>
        <span class="k">if</span> <span class="n">padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pad_left</span><span class="p">,</span> <span class="n">pad_right</span><span class="p">,</span> <span class="n">pad_top</span><span class="p">,</span> <span class="n">pad_bottom</span> <span class="o">=</span> <span class="n">padding</span>
            <span class="n">padding</span> <span class="o">=</span> <span class="p">[</span><span class="n">pad_left</span><span class="p">,</span> <span class="n">pad_top</span><span class="p">,</span> <span class="n">pad_right</span><span class="p">,</span> <span class="n">pad_bottom</span><span class="p">]</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;padding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">padding</span>

        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">padding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pad_if_needed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_FillType</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_FillType</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">padding_mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span> <span class="s2">&quot;reflect&quot;</span><span class="p">,</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">_setup_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;Please provide only two dimensions (h, w) for size.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pad_if_needed</span> <span class="ow">or</span> <span class="n">padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_check_padding_arg</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
            <span class="n">_check_padding_mode_arg</span><span class="p">(</span><span class="n">padding_mode</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">_geometry</span><span class="o">.</span><span class="n">_parse_pad_padding</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span> <span class="k">if</span> <span class="n">padding</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad_if_needed</span> <span class="o">=</span> <span class="n">pad_if_needed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">_setup_fill_arg</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding_mode</span> <span class="o">=</span> <span class="n">padding_mode</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">padded_height</span><span class="p">,</span> <span class="n">padded_width</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pad_left</span><span class="p">,</span> <span class="n">pad_right</span><span class="p">,</span> <span class="n">pad_top</span><span class="p">,</span> <span class="n">pad_bottom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>
            <span class="n">padded_height</span> <span class="o">+=</span> <span class="n">pad_top</span> <span class="o">+</span> <span class="n">pad_bottom</span>
            <span class="n">padded_width</span> <span class="o">+=</span> <span class="n">pad_left</span> <span class="o">+</span> <span class="n">pad_right</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pad_left</span> <span class="o">=</span> <span class="n">pad_right</span> <span class="o">=</span> <span class="n">pad_top</span> <span class="o">=</span> <span class="n">pad_bottom</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">cropped_height</span><span class="p">,</span> <span class="n">cropped_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_if_needed</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">padded_height</span> <span class="o">&lt;</span> <span class="n">cropped_height</span><span class="p">:</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">cropped_height</span> <span class="o">-</span> <span class="n">padded_height</span>

                <span class="n">pad_top</span> <span class="o">+=</span> <span class="n">diff</span>
                <span class="n">pad_bottom</span> <span class="o">+=</span> <span class="n">diff</span>
                <span class="n">padded_height</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">diff</span>

            <span class="k">if</span> <span class="n">padded_width</span> <span class="o">&lt;</span> <span class="n">cropped_width</span><span class="p">:</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">cropped_width</span> <span class="o">-</span> <span class="n">padded_width</span>

                <span class="n">pad_left</span> <span class="o">+=</span> <span class="n">diff</span>
                <span class="n">pad_right</span> <span class="o">+=</span> <span class="n">diff</span>
                <span class="n">padded_width</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">diff</span>

        <span class="k">if</span> <span class="n">padded_height</span> <span class="o">&lt;</span> <span class="n">cropped_height</span> <span class="ow">or</span> <span class="n">padded_width</span> <span class="o">&lt;</span> <span class="n">cropped_width</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Required crop size </span><span class="si">{</span><span class="p">(</span><span class="n">cropped_height</span><span class="p">,</span><span class="w"> </span><span class="n">cropped_width</span><span class="p">)</span><span class="si">}</span><span class="s2"> is larger than &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;padded &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">input image size </span><span class="si">{</span><span class="p">(</span><span class="n">padded_height</span><span class="p">,</span><span class="w"> </span><span class="n">padded_width</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># We need a different order here than we have in self.padding since this padding will be parsed again in `F.pad`</span>
        <span class="n">padding</span> <span class="o">=</span> <span class="p">[</span><span class="n">pad_left</span><span class="p">,</span> <span class="n">pad_top</span><span class="p">,</span> <span class="n">pad_right</span><span class="p">,</span> <span class="n">pad_bottom</span><span class="p">]</span>
        <span class="n">needs_pad</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>

        <span class="n">needs_vert_crop</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">padded_height</span> <span class="o">-</span> <span class="n">cropped_height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">())))</span>
            <span class="k">if</span> <span class="n">padded_height</span> <span class="o">&gt;</span> <span class="n">cropped_height</span>
            <span class="k">else</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">needs_horz_crop</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">padded_width</span> <span class="o">-</span> <span class="n">cropped_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">())))</span>
            <span class="k">if</span> <span class="n">padded_width</span> <span class="o">&gt;</span> <span class="n">cropped_width</span>
            <span class="k">else</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">needs_crop</span><span class="o">=</span><span class="n">needs_vert_crop</span> <span class="ow">or</span> <span class="n">needs_horz_crop</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="n">cropped_height</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">cropped_width</span><span class="p">,</span>
            <span class="n">needs_pad</span><span class="o">=</span><span class="n">needs_pad</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;needs_pad&quot;</span><span class="p">]:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">_get_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">))</span>
            <span class="n">inpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;padding&quot;</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding_mode</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;needs_crop&quot;</span><span class="p">]:</span>
            <span class="n">inpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
                <span class="n">F</span><span class="o">.</span><span class="n">crop</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span> <span class="n">left</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">inpt</span></div>


<div class="viewcode-block" id="RandomPerspective"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomPerspective.html#torchvision.transforms.v2.RandomPerspective">[docs]</a><span class="k">class</span> <span class="nc">RandomPerspective</span><span class="p">(</span><span class="n">_RandomApplyTransform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a random perspective transformation of the input with a given probability.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        distortion_scale (float, optional): argument to control the degree of distortion and ranges from 0 to 1.</span>
<span class="sd">            Default is 0.5.</span>
<span class="sd">        p (float, optional): probability of the input being transformed. Default is 0.5.</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.BILINEAR``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.BILINEAR`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        fill (number or tuple or dict, optional): Pixel fill value used when the  ``padding_mode`` is constant.</span>
<span class="sd">            Default is 0. If a tuple of length 3, it is used to fill R, G, B channels respectively.</span>
<span class="sd">            Fill value can be also a dictionary mapping data type to the fill value, e.g.</span>
<span class="sd">            ``fill={tv_tensors.Image: 127, tv_tensors.Mask: 0}`` where ``Image`` will be filled with 127 and</span>
<span class="sd">            ``Mask`` will be filled with 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">RandomPerspective</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">distortion_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_FillType</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_FillType</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">distortion_scale</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Argument distortion_scale value should be between 0 and 1&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">distortion_scale</span> <span class="o">=</span> <span class="n">distortion_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">_setup_fill_arg</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>

        <span class="n">distortion_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distortion_scale</span>

        <span class="n">half_height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">half_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">bound_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distortion_scale</span> <span class="o">*</span> <span class="n">half_height</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">bound_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distortion_scale</span> <span class="o">*</span> <span class="n">half_width</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">topleft</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bound_width</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bound_height</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
        <span class="p">]</span>
        <span class="n">topright</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">bound_width</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bound_height</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
        <span class="p">]</span>
        <span class="n">botright</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">bound_width</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">bound_height</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
        <span class="p">]</span>
        <span class="n">botleft</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bound_width</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">bound_height</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))),</span>
        <span class="p">]</span>
        <span class="n">startpoints</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="n">endpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">topleft</span><span class="p">,</span> <span class="n">topright</span><span class="p">,</span> <span class="n">botright</span><span class="p">,</span> <span class="n">botleft</span><span class="p">]</span>
        <span class="n">perspective_coeffs</span> <span class="o">=</span> <span class="n">_get_perspective_coeffs</span><span class="p">(</span><span class="n">startpoints</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">perspective_coeffs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">_get_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">perspective</span><span class="p">,</span>
            <span class="n">inpt</span><span class="p">,</span>
            <span class="n">startpoints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">endpoints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span>
            <span class="o">**</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ElasticTransform"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.ElasticTransform.html#torchvision.transforms.v2.ElasticTransform">[docs]</a><span class="k">class</span> <span class="nc">ElasticTransform</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform the input with elastic transformations.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Given alpha and sigma, it will generate displacement</span>
<span class="sd">    vectors for all pixels based on random offsets. Alpha controls the strength</span>
<span class="sd">    and sigma controls the smoothness of the displacements.</span>
<span class="sd">    The displacements are added to an identity grid and the resulting grid is</span>
<span class="sd">    used to transform the input.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Implementation to transform bounding boxes is approximative (not exact).</span>
<span class="sd">        We construct an approximation of the inverse grid as ``inverse_grid = identity - displacement``.</span>
<span class="sd">        This is not an exact inverse of the grid used to transform images, i.e. ``grid = identity + displacement``.</span>
<span class="sd">        Our assumption is that ``displacement * displacement`` is small and can be ignored.</span>
<span class="sd">        Large displacements would lead to large errors in the approximation.</span>

<span class="sd">    Applications:</span>
<span class="sd">        Randomly transforms the morphology of objects in images and produces a</span>
<span class="sd">        see-through-water-like effect.</span>

<span class="sd">    Args:</span>
<span class="sd">        alpha (float or sequence of floats, optional): Magnitude of displacements. Default is 50.0.</span>
<span class="sd">        sigma (float or sequence of floats, optional): Smoothness of displacements. Default is 5.0.</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.BILINEAR``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.BILINEAR`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        fill (number or tuple or dict, optional): Pixel fill value used when the  ``padding_mode`` is constant.</span>
<span class="sd">            Default is 0. If a tuple of length 3, it is used to fill R, G, B channels respectively.</span>
<span class="sd">            Fill value can be also a dictionary mapping data type to the fill value, e.g.</span>
<span class="sd">            ``fill={tv_tensors.Image: 127, tv_tensors.Mask: 0}`` where ``Image`` will be filled with 127 and</span>
<span class="sd">            ``Mask`` will be filled with 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_v1_transform_cls</span> <span class="o">=</span> <span class="n">_transforms</span><span class="o">.</span><span class="n">ElasticTransform</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">50.0</span><span class="p">,</span>
        <span class="n">sigma</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_FillType</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">_FillType</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">_setup_number_or_seq</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">_setup_number_or_seq</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">_setup_fill_arg</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">))</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">kx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># if kernel size is even we have to make it odd</span>
            <span class="k">if</span> <span class="n">kx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">kx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gaussian_blur</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="p">[</span><span class="n">kx</span><span class="p">,</span> <span class="n">kx</span><span class="p">],</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">))</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">dy</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">ky</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># if kernel size is even we have to make it odd</span>
            <span class="k">if</span> <span class="n">ky</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ky</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gaussian_blur</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="p">[</span><span class="n">ky</span><span class="p">,</span> <span class="n">ky</span><span class="p">],</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">))</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">displacement</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">permute</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># 1 x H x W x 2</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">displacement</span><span class="o">=</span><span class="n">displacement</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">_get_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">inpt</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">elastic</span><span class="p">,</span>
            <span class="n">inpt</span><span class="p">,</span>
            <span class="o">**</span><span class="n">params</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="RandomIoUCrop"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomIoUCrop.html#torchvision.transforms.v2.RandomIoUCrop">[docs]</a><span class="k">class</span> <span class="nc">RandomIoUCrop</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Random IoU crop transformation from</span>
<span class="sd">    `&quot;SSD: Single Shot MultiBox Detector&quot; &lt;https://arxiv.org/abs/1512.02325&gt;`_.</span>

<span class="sd">    This transformation requires an image or video data and ``tv_tensors.BoundingBoxes`` in the input.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        In order to properly remove the bounding boxes below the IoU threshold, `RandomIoUCrop`</span>
<span class="sd">        must be followed by :class:`~torchvision.transforms.v2.SanitizeBoundingBoxes`, either immediately</span>
<span class="sd">        after or later in the transforms pipeline.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        min_scale (float, optional): Minimum factors to scale the input size.</span>
<span class="sd">        max_scale (float, optional): Maximum factors to scale the input size.</span>
<span class="sd">        min_aspect_ratio (float, optional): Minimum aspect ratio for the cropped image or video.</span>
<span class="sd">        max_aspect_ratio (float, optional): Maximum aspect ratio for the cropped image or video.</span>
<span class="sd">        sampler_options (list of float, optional): List of minimal IoU (Jaccard) overlap between all the boxes and</span>
<span class="sd">            a cropped image or video. Default, ``None`` which corresponds to ``[0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0]``</span>
<span class="sd">        trials (int, optional): Number of trials to find a crop for a given value of minimal IoU (Jaccard) overlap.</span>
<span class="sd">            Default, 40.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">min_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="n">max_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">min_aspect_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">max_aspect_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">sampler_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Configuration similar to https://github.com/weiliu89/caffe/blob/ssd/examples/ssd/ssd_coco.py#L89-L174</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_scale</span> <span class="o">=</span> <span class="n">min_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_scale</span> <span class="o">=</span> <span class="n">max_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_aspect_ratio</span> <span class="o">=</span> <span class="n">min_aspect_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_aspect_ratio</span> <span class="o">=</span> <span class="n">max_aspect_ratio</span>
        <span class="k">if</span> <span class="n">sampler_options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sampler_options</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">sampler_options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trials</span> <span class="o">=</span> <span class="n">trials</span>

    <span class="k">def</span> <span class="nf">_check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">has_all</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">BoundingBoxes</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">has_any</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">,</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="n">is_pure_tensor</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">() requires input sample to contain tensor or PIL images &quot;</span>
                <span class="s2">&quot;and bounding boxes. Sample can also contain masks.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">orig_h</span><span class="p">,</span> <span class="n">orig_w</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>
        <span class="n">bboxes</span> <span class="o">=</span> <span class="n">get_bounding_boxes</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># sample an option</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)))</span>
            <span class="n">min_jaccard_overlap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">min_jaccard_overlap</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>  <span class="c1"># a value larger than 1 encodes the leave as-is option</span>
                <span class="k">return</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trials</span><span class="p">):</span>
                <span class="c1"># check the aspect ratio limitations</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_scale</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_scale</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_scale</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">new_w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_w</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">new_h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_h</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">new_w</span> <span class="o">/</span> <span class="n">new_h</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_aspect_ratio</span> <span class="o">&lt;=</span> <span class="n">aspect_ratio</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_aspect_ratio</span><span class="p">):</span>
                    <span class="k">continue</span>

                <span class="c1"># check for 0 area crops</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">orig_w</span> <span class="o">-</span> <span class="n">new_w</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">top</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">orig_h</span> <span class="o">-</span> <span class="n">new_h</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">left</span> <span class="o">+</span> <span class="n">new_w</span>
                <span class="n">bottom</span> <span class="o">=</span> <span class="n">top</span> <span class="o">+</span> <span class="n">new_h</span>
                <span class="k">if</span> <span class="n">left</span> <span class="o">==</span> <span class="n">right</span> <span class="ow">or</span> <span class="n">top</span> <span class="o">==</span> <span class="n">bottom</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># check for any valid boxes with centers within the crop area</span>
                <span class="n">xyxy_bboxes</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">convert_bounding_box_format</span><span class="p">(</span>
                    <span class="n">bboxes</span><span class="o">.</span><span class="n">as_subclass</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">),</span>
                    <span class="n">bboxes</span><span class="o">.</span><span class="n">format</span><span class="p">,</span>
                    <span class="n">tv_tensors</span><span class="o">.</span><span class="n">BoundingBoxFormat</span><span class="o">.</span><span class="n">XYXY</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">cx</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">xyxy_bboxes</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xyxy_bboxes</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
                <span class="n">cy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">xyxy_bboxes</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xyxy_bboxes</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
                <span class="n">is_within_crop_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">cx</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cx</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">top</span> <span class="o">&lt;</span> <span class="n">cy</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cy</span> <span class="o">&lt;</span> <span class="n">bottom</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_within_crop_area</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                    <span class="k">continue</span>

                <span class="c1"># check at least 1 box with jaccard limitations</span>
                <span class="n">xyxy_bboxes</span> <span class="o">=</span> <span class="n">xyxy_bboxes</span><span class="p">[</span><span class="n">is_within_crop_area</span><span class="p">]</span>
                <span class="n">ious</span> <span class="o">=</span> <span class="n">box_iou</span><span class="p">(</span>
                    <span class="n">xyxy_bboxes</span><span class="p">,</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">xyxy_bboxes</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">xyxy_bboxes</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">ious</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">min_jaccard_overlap</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">new_h</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">new_w</span><span class="p">,</span> <span class="n">is_within_crop_area</span><span class="o">=</span><span class="n">is_within_crop_area</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inpt</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">crop</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span> <span class="n">left</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">tv_tensors</span><span class="o">.</span><span class="n">BoundingBoxes</span><span class="p">):</span>
            <span class="c1"># We &quot;mark&quot; the invalid boxes as degenreate, and they can be</span>
            <span class="c1"># removed by a later call to SanitizeBoundingBoxes()</span>
            <span class="n">output</span><span class="p">[</span><span class="o">~</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;is_within_crop_area&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="ScaleJitter"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.ScaleJitter.html#torchvision.transforms.v2.ScaleJitter">[docs]</a><span class="k">class</span> <span class="nc">ScaleJitter</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform Large Scale Jitter on the input according to</span>
<span class="sd">    `&quot;Simple Copy-Paste is a Strong Data Augmentation Method for Instance Segmentation&quot; &lt;https://arxiv.org/abs/2012.07177&gt;`_.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        target_size (tuple of int): Target size. This parameter defines base scale for jittering,</span>
<span class="sd">            e.g. ``min(target_size[0] / width, target_size[1] / height)``.</span>
<span class="sd">        scale_range (tuple of float, optional): Minimum and maximum of the scale range. Default, ``(0.1, 2.0)``.</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.BILINEAR``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.NEAREST_EXACT``,</span>
<span class="sd">            ``InterpolationMode.BILINEAR`` and ``InterpolationMode.BICUBIC`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        antialias (bool, optional): Whether to apply antialiasing.</span>
<span class="sd">            It only affects **tensors** with bilinear or bicubic modes and it is</span>
<span class="sd">            ignored otherwise: on PIL images, antialiasing is always applied on</span>
<span class="sd">            bilinear or bicubic modes; on other modes (for PIL images and</span>
<span class="sd">            tensors), antialiasing makes no sense and this parameter is ignored.</span>
<span class="sd">            Possible values are:</span>

<span class="sd">            - ``True`` (default): will apply antialiasing for bilinear or bicubic modes.</span>
<span class="sd">              Other mode aren&#39;t affected. This is probably what you want to use.</span>
<span class="sd">            - ``False``: will not apply antialiasing for tensors on any mode. PIL</span>
<span class="sd">              images are still antialiased on bilinear or bicubic modes, because</span>
<span class="sd">              PIL doesn&#39;t support no antialias.</span>
<span class="sd">            - ``None``: equivalent to ``False`` for tensors and ``True`` for</span>
<span class="sd">              PIL images. This value exists for legacy reasons and you probably</span>
<span class="sd">              don&#39;t want to use it unless you really know what you are doing.</span>

<span class="sd">            The default value changed from ``None`` to ``True`` in</span>
<span class="sd">            v0.17, for the PIL and Tensor backends to be consistent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target_size</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">scale_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
        <span class="n">antialias</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_size</span> <span class="o">=</span> <span class="n">target_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_range</span> <span class="o">=</span> <span class="n">scale_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antialias</span> <span class="o">=</span> <span class="n">antialias</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">orig_height</span><span class="p">,</span> <span class="n">orig_width</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>

        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">orig_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">orig_width</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
        <span class="n">new_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_width</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">new_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_height</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">new_height</span><span class="p">,</span> <span class="n">new_width</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">resize</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">antialias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">antialias</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="RandomShortestSize"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomShortestSize.html#torchvision.transforms.v2.RandomShortestSize">[docs]</a><span class="k">class</span> <span class="nc">RandomShortestSize</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomly resize the input.</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        min_size (int or sequence of int): Minimum spatial size. Single integer value or a sequence of integer values.</span>
<span class="sd">        max_size (int, optional): Maximum spatial size. Default, None.</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.BILINEAR``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.NEAREST_EXACT``,</span>
<span class="sd">            ``InterpolationMode.BILINEAR`` and ``InterpolationMode.BICUBIC`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        antialias (bool, optional): Whether to apply antialiasing.</span>
<span class="sd">            It only affects **tensors** with bilinear or bicubic modes and it is</span>
<span class="sd">            ignored otherwise: on PIL images, antialiasing is always applied on</span>
<span class="sd">            bilinear or bicubic modes; on other modes (for PIL images and</span>
<span class="sd">            tensors), antialiasing makes no sense and this parameter is ignored.</span>
<span class="sd">            Possible values are:</span>

<span class="sd">            - ``True`` (default): will apply antialiasing for bilinear or bicubic modes.</span>
<span class="sd">              Other mode aren&#39;t affected. This is probably what you want to use.</span>
<span class="sd">            - ``False``: will not apply antialiasing for tensors on any mode. PIL</span>
<span class="sd">              images are still antialiased on bilinear or bicubic modes, because</span>
<span class="sd">              PIL doesn&#39;t support no antialias.</span>
<span class="sd">            - ``None``: equivalent to ``False`` for tensors and ``True`` for</span>
<span class="sd">              PIL images. This value exists for legacy reasons and you probably</span>
<span class="sd">              don&#39;t want to use it unless you really know what you are doing.</span>

<span class="sd">            The default value changed from ``None`` to ``True`` in</span>
<span class="sd">            v0.17, for the PIL and Tensor backends to be consistent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">min_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">max_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
        <span class="n">antialias</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_size</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">min_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">min_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">=</span> <span class="n">max_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antialias</span> <span class="o">=</span> <span class="n">antialias</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">orig_height</span><span class="p">,</span> <span class="n">orig_width</span> <span class="o">=</span> <span class="n">query_size</span><span class="p">(</span><span class="n">flat_inputs</span><span class="p">)</span>

        <span class="n">min_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_size</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_size</span><span class="p">),</span> <span class="p">()))]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">min_size</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">orig_height</span><span class="p">,</span> <span class="n">orig_width</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">orig_height</span><span class="p">,</span> <span class="n">orig_width</span><span class="p">))</span>

        <span class="n">new_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_width</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">new_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orig_height</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">new_height</span><span class="p">,</span> <span class="n">new_width</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">resize</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">antialias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">antialias</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="RandomResize"><a class="viewcode-back" href="../../../../generated/torchvision.transforms.v2.RandomResize.html#torchvision.transforms.v2.RandomResize">[docs]</a><span class="k">class</span> <span class="nc">RandomResize</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomly resize the input.</span>

<span class="sd">    This transformation can be used together with ``RandomCrop`` as data augmentations to train</span>
<span class="sd">    models on image segmentation task.</span>

<span class="sd">    Output spatial size is randomly sampled from the interval ``[min_size, max_size]``:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        size = uniform_sample(min_size, max_size)</span>
<span class="sd">        output_width = size</span>
<span class="sd">        output_height = size</span>

<span class="sd">    If the input is a :class:`torch.Tensor` or a ``TVTensor`` (e.g. :class:`~torchvision.tv_tensors.Image`,</span>
<span class="sd">    :class:`~torchvision.tv_tensors.Video`, :class:`~torchvision.tv_tensors.BoundingBoxes` etc.)</span>
<span class="sd">    it can have arbitrary number of leading batch dimensions. For example,</span>
<span class="sd">    the image can have ``[..., C, H, W]`` shape. A bounding box can have ``[..., 4]`` shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        min_size (int): Minimum output size for random sampling</span>
<span class="sd">        max_size (int): Maximum output size for random sampling</span>
<span class="sd">        interpolation (InterpolationMode, optional): Desired interpolation enum defined by</span>
<span class="sd">            :class:`torchvision.transforms.InterpolationMode`. Default is ``InterpolationMode.BILINEAR``.</span>
<span class="sd">            If input is Tensor, only ``InterpolationMode.NEAREST``, ``InterpolationMode.NEAREST_EXACT``,</span>
<span class="sd">            ``InterpolationMode.BILINEAR`` and ``InterpolationMode.BICUBIC`` are supported.</span>
<span class="sd">            The corresponding Pillow integer constants, e.g. ``PIL.Image.BILINEAR`` are accepted as well.</span>
<span class="sd">        antialias (bool, optional): Whether to apply antialiasing.</span>
<span class="sd">            It only affects **tensors** with bilinear or bicubic modes and it is</span>
<span class="sd">            ignored otherwise: on PIL images, antialiasing is always applied on</span>
<span class="sd">            bilinear or bicubic modes; on other modes (for PIL images and</span>
<span class="sd">            tensors), antialiasing makes no sense and this parameter is ignored.</span>
<span class="sd">            Possible values are:</span>

<span class="sd">            - ``True`` (default): will apply antialiasing for bilinear or bicubic modes.</span>
<span class="sd">              Other mode aren&#39;t affected. This is probably what you want to use.</span>
<span class="sd">            - ``False``: will not apply antialiasing for tensors on any mode. PIL</span>
<span class="sd">              images are still antialiased on bilinear or bicubic modes, because</span>
<span class="sd">              PIL doesn&#39;t support no antialias.</span>
<span class="sd">            - ``None``: equivalent to ``False`` for tensors and ``True`` for</span>
<span class="sd">              PIL images. This value exists for legacy reasons and you probably</span>
<span class="sd">              don&#39;t want to use it unless you really know what you are doing.</span>

<span class="sd">            The default value changed from ``None`` to ``True`` in</span>
<span class="sd">            v0.17, for the PIL and Tensor backends to be consistent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">min_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">max_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterpolationMode</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">,</span>
        <span class="n">antialias</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_size</span> <span class="o">=</span> <span class="n">min_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">=</span> <span class="n">max_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antialias</span> <span class="o">=</span> <span class="n">antialias</span>

    <span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_inputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">,</span> <span class="p">()))</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">size</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inpt</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_kernel</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">resize</span><span class="p">,</span> <span class="n">inpt</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">antialias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">antialias</span>
        <span class="p">)</span></div>
</pre></div>

             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-present, Torch Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
         <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
         <script src="../../../../_static/jquery.js"></script>
         <script src="../../../../_static/underscore.js"></script>
         <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="../../../../_static/doctools.js"></script>
         <script src="../../../../_static/clipboard.min.js"></script>
         <script src="../../../../_static/copybutton.js"></script>
     

  

  <script type="text/javascript" src="../../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">Stay up to date</li>
            <li><a href="https://www.facebook.com/pytorch" target="_blank">Facebook</a></li>
            <li><a href="https://twitter.com/pytorch" target="_blank">Twitter</a></li>
            <li><a href="https://www.youtube.com/pytorch" target="_blank">YouTube</a></li>
            <li><a href="https://www.linkedin.com/company/pytorch" target="_blank">LinkedIn</a></li>
          </ul>  
          </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">PyTorch Podcasts</li>
            <li><a href="https://open.spotify.com/show/6UzHKeiy368jKfQMKKvJY5" target="_blank">Spotify</a></li>
            <li><a href="https://podcasts.apple.com/us/podcast/pytorch-developer-podcast/id1566080008" target="_blank">Apple</a></li>
            <li><a href="https://www.google.com/podcasts?feed=aHR0cHM6Ly9mZWVkcy5zaW1wbGVjYXN0LmNvbS9PQjVGa0lsOA%3D%3D" target="_blank">Google</a></li>
            <li><a href="https://music.amazon.com/podcasts/7a4e6f0e-26c2-49e9-a478-41bd244197d0/PyTorch-Developer-Podcast?" target="_blank">Amazon</a></li>
          </ul>
         </div>
        </div>
        
        <div class="privacy-policy">
          <ul>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/terms/" target="_blank">Terms</a></li>
            <li class="privacy-policy-links">|</li>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/privacy-policy/" target="_blank">Privacy</a></li>
          </ul>
        </div>
        <div class="copyright">
        <p>Â© Copyright The Linux Foundation. The PyTorch Foundation is a project of The Linux Foundation.
          For web site terms of use, trademark policy and other policies applicable to The PyTorch Foundation please see
          <a href="https://www.linuxfoundation.org/policies/">www.linuxfoundation.org/policies/</a>. The PyTorch Foundation supports the PyTorch open source
          project, which has been established as PyTorch Project a Series of LF Projects, LLC. For policies applicable to the PyTorch Project a Series of LF Projects, LLC,
          please see <a href="https://www.lfprojects.org/policies/">www.lfprojects.org/policies/</a>.</p>
      </div>
     </div>

  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebookâ€™s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>
            
          <li>
            <a href="">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="resources-mobile-menu-title" class="active">
            Docs
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
            </li>

            <li>
              <a href="https://pytorch.org/text/stable/index.html">torchtext</a>
            </li>

            <li>
              <a href="https://pytorch.org/vision/stable/index.html">torchvision</a>
            </li>

            <li>
              <a href="https://pytorch.org/torcharrow">torcharrow</a>
            </li>

            <li>
              <a href="https://pytorch.org/data">TorchData</a>
            </li>

            <li>
              <a href="https://pytorch.org/torchrec">TorchRec</a>
            </li>

            <li>
              <a href="https://pytorch.org/serve/">TorchServe</a>
            </li>

            <li>
              <a href="https://pytorch.org/torchx/">TorchX</a>
            </li>

            <li>
              <a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            Resources
          </li>
            
           <ul class="resources-mobile-menu-items">

            <li>
              <a href="https://pytorch.org/features">About</a>
            </li>

            <li>
              <a href="https://pytorch.org/foundation">PyTorch Foundation</a>
            </li>

            <li>
              <a href="https://pytorch.org/#community-module">Community</a>
            </li>

            <li>
              <a href="https://pytorch.org/community-stories">Community Stories</a>
            </li>

            <li>
              <a href="https://pytorch.org/resources">Developer Resources</a>
            </li>

            <li>
              <a href="https://pytorch.org/events">Events</a>
            </li>

            <li>
              <a href="https://discuss.pytorch.org/">Forums</a>
            </li>

            <li>
              <a href="https://pytorch.org/hub">Models (Beta)</a>
            </li>
          </ul>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>